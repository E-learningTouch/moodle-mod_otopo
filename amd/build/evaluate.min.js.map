{"version":3,"file":"evaluate.min.js","sources":["../src/evaluate.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Evaluate.\n *\n * @copyright   2024 Nantes Universit√© <support-tice@univ-nantes.fr> (Commissioner)\n * @copyright   2024 E-learning Touch' <contact@elearningtouch.com> (Maintainer)\n * @copyright   2022 Kosmos <moodle@kosmos.fr> (Former maintainer)\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'vue',\n    'mod_otopo/preview_sessions/components/items',\n    'mod_otopo/items/ajax',\n    'mod_otopo/otopo/ajax',\n    'mod_otopo/utils',\n    'core/log'\n], function(\n    Vue,\n    Items,\n    ajaxItems,\n    ajaxOtopo,\n    utils,\n    Log\n) {\n    return {\n        init: function(otopo, showComments, session, sessionValid, isOpen, starPng, starContainerPng, helpPng, plusPng, minusPng) {\n            var images = {\n                'star': starPng,\n                'starContainer': starContainerPng,\n                'help': helpPng,\n                'plus': plusPng,\n                'minus': minusPng\n            };\n\n            ajaxItems.getItems(otopo).then((items) => {\n                ajaxOtopo.getUserOtopo(otopo, session).then((otopos) => {\n                    const otoposO = {};\n                    otopos.forEach(o => {\n                        otoposO[o.item] = o;\n                        if (o.id === null && o.degree !== null) {\n                            ajaxOtopo.setUserOtopo(otopo, session, o.item, o.degree, o.justification);\n                        }\n                    });\n                    utils.getAutoEvalStrings().then((strings) => {\n                        new Vue({\n                            el: '#evaluate',\n                            components: {\n                                'Items': Items,\n                            },\n                            template: '<Items></Items>',\n                            data: {\n                                otopo: otopo,\n                                showComments: showComments,\n                                session: session,\n                                active: !sessionValid && isOpen,\n                                items: items,\n                                strings: strings,\n                                images: images,\n                                otopos: otoposO\n                            }\n                        });\n                        return true;\n                    }).catch(Log.error);\n                    return true;\n                }).catch(Log.error);\n                return true;\n            }).catch(Log.error);\n        }\n    };\n});\n"],"names":["define","Vue","Items","ajaxItems","ajaxOtopo","utils","Log","init","otopo","showComments","session","sessionValid","isOpen","starPng","starContainerPng","helpPng","plusPng","minusPng","images","star","starContainer","help","plus","minus","getItems","then","items","getUserOtopo","otopos","otoposO","forEach","o","item","id","degree","setUserOtopo","justification","getAutoEvalStrings","strings","el","components","template","data","active","catch","error"],"mappings":"AAuBAA,OAAO,qBAAA,CACH,MACA,8CACA,uBACA,uBACA,kBACA,aACD,SACCC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,MAAO,CACHC,KAAM,SAASC,EAAOC,EAAcC,EAASC,EAAcC,EAAQC,EAASC,EAAkBC,EAASC,EAASC,GAC5G,IAAIC,EAAS,CACTC,KAAQN,EACRO,cAAiBN,EACjBO,KAAQN,EACRO,KAAQN,EACRO,MAASN,GAGbd,EAAUqB,SAAShB,GAAOiB,MAAMC,IAC5BtB,EAAUuB,aAAanB,EAAOE,GAASe,MAAMG,IACzC,MAAMC,EAAU,CAAE,EA2BlB,OA1BAD,EAAOE,SAAQC,IACXF,EAAQE,EAAEC,MAAQD,EACL,OAATA,EAAEE,IAA4B,OAAbF,EAAEG,QACnB9B,EAAU+B,aAAa3B,EAAOE,EAASqB,EAAEC,KAAMD,EAAEG,OAAQH,EAAEK,cAAa,IAGhF/B,EAAMgC,qBAAqBZ,MAAMa,IAC7B,IAAIrC,EAAI,CACJsC,GAAI,YACJC,WAAY,CACRtC,MAASA,GAEbuC,SAAU,kBACVC,KAAM,CACFlC,MAAOA,EACPC,aAAcA,EACdC,QAASA,EACTiC,QAAShC,GAAgBC,EACzBc,MAAOA,EACPY,QAASA,EACTpB,OAAQA,EACRU,OAAQC,MAGT,KACRe,MAAMtC,EAAIuC,QACN,KACRD,MAAMtC,EAAIuC,QACN,KACRD,MAAMtC,EAAIuC,MACjB,EAER"}