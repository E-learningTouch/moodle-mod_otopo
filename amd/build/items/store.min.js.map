{"version":3,"file":"store.min.js","sources":["../../src/items/store.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Items store.\n *\n * @copyright   2024 Nantes Universit√© <support-tice@univ-nantes.fr> (Commissioner)\n * @copyright   2024 E-learning Touch' <contact@elearningtouch.com> (Maintainer)\n * @copyright   2022 Kosmos <moodle@kosmos.fr> (Former maintainer)\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([], function() {\n    return {\n        state: {\n            items: [],\n            draggingItem: false,\n            draggingDegree: false,\n        },\n        addItem: function(item) {\n            this.state.items.push(item);\n        },\n        addItemAfter: function(index, item) {\n            var itemsToPersist = [];\n            this.state.items.splice(index, 0, item);\n            if (this.state.items.length > index + 1 && this.state.items[index + 1].ord <= item.ord) {\n                var j = 1;\n                for (var i = index + 1; i < this.state.items.length; i++) {\n                    this.state.items[i].ord = item.ord + j;\n                    itemsToPersist.push(this.state.items[i]);\n                    ++j;\n                }\n            }\n            return itemsToPersist;\n        },\n        deleteItem: function(index) {\n            var deletedItem = null;\n            for (var i = 0; i < this.state.items.length; i++) {\n                if (i === index) {\n                    deletedItem = this.state.items[i];\n                    this.state.items.splice(i, 1);\n                    break;\n                }\n            }\n            return deletedItem;\n        },\n        addDegreeToItem: function(item, degree) {\n            item.degrees.push(degree);\n        },\n        addDegreeToItemAfter: function(index, item, degree) {\n            var degreesToPersist = [];\n            item.degrees.splice(index, 0, degree);\n            if (item.degrees.length > index + 1 && item.degrees[index + 1].ord <= degree.ord) {\n                var j = 1;\n                for (var i = index + 1; i < item.degrees.length; i++) {\n                    item.degrees[i].ord = degree.ord + j;\n                    degreesToPersist.push(item.degrees[i]);\n                    ++j;\n                }\n            }\n            return degreesToPersist;\n        },\n        deleteDegreeFromItem: function(item, degreeIndex) {\n            var deletedDegree = null;\n            for (var i = 0; i < item.degrees.length; i++) {\n                if (i === degreeIndex) {\n                    deletedDegree = item.degrees[i];\n                    item.degrees.splice(i, 1);\n                    break;\n                }\n            }\n            return deletedDegree;\n        },\n        startDraggingItem: function() {\n            this.state.draggingItem = true;\n        },\n        stopDraggingItem: function() {\n            this.state.draggingItem = false;\n        },\n        startDraggingDegree: function() {\n            this.state.draggingDegree = true;\n        },\n        stopDraggingDegree: function() {\n            this.state.draggingDegree = false;\n        }\n    };\n});\n"],"names":["define","state","items","draggingItem","draggingDegree","addItem","item","this","push","addItemAfter","index","itemsToPersist","splice","length","ord","j","i","deleteItem","deletedItem","addDegreeToItem","degree","degrees","addDegreeToItemAfter","degreesToPersist","deleteDegreeFromItem","degreeIndex","deletedDegree","startDraggingItem","stopDraggingItem","startDraggingDegree","stopDraggingDegree"],"mappings":"AAuBAA,OAAM,wBAAC,IAAI,WACP,MAAO,CACHC,MAAO,CACHC,MAAO,GACPC,cAAc,EACdC,gBAAgB,GAEpBC,QAAS,SAASC,GACdC,KAAKN,MAAMC,MAAMM,KAAKF,EAC1B,EACAG,aAAc,SAASC,EAAOJ,GAC1B,IAAIK,EAAiB,GAErB,GADAJ,KAAKN,MAAMC,MAAMU,OAAOF,EAAO,EAAGJ,GAC9BC,KAAKN,MAAMC,MAAMW,OAASH,EAAQ,GAAKH,KAAKN,MAAMC,MAAMQ,EAAQ,GAAGI,KAAOR,EAAKQ,IAE/E,IADA,IAAIC,EAAI,EACCC,EAAIN,EAAQ,EAAGM,EAAIT,KAAKN,MAAMC,MAAMW,OAAQG,IACjDT,KAAKN,MAAMC,MAAMc,GAAGF,IAAMR,EAAKQ,IAAMC,EACrCJ,EAAeH,KAAKD,KAAKN,MAAMC,MAAMc,MACnCD,EAGV,OAAOJ,CACX,EACAM,WAAY,SAASP,GAEjB,IADA,IAAIQ,EAAc,KACTF,EAAI,EAAGA,EAAIT,KAAKN,MAAMC,MAAMW,OAAQG,IACzC,GAAIA,IAAMN,EAAO,CACbQ,EAAcX,KAAKN,MAAMC,MAAMc,GAC/BT,KAAKN,MAAMC,MAAMU,OAAOI,EAAG,GAC3B,KACJ,CAEJ,OAAOE,CACX,EACAC,gBAAiB,SAASb,EAAMc,GAC5Bd,EAAKe,QAAQb,KAAKY,EACtB,EACAE,qBAAsB,SAASZ,EAAOJ,EAAMc,GACxC,IAAIG,EAAmB,GAEvB,GADAjB,EAAKe,QAAQT,OAAOF,EAAO,EAAGU,GAC1Bd,EAAKe,QAAQR,OAASH,EAAQ,GAAKJ,EAAKe,QAAQX,EAAQ,GAAGI,KAAOM,EAAON,IAEzE,IADA,IAAIC,EAAI,EACCC,EAAIN,EAAQ,EAAGM,EAAIV,EAAKe,QAAQR,OAAQG,IAC7CV,EAAKe,QAAQL,GAAGF,IAAMM,EAAON,IAAMC,EACnCQ,EAAiBf,KAAKF,EAAKe,QAAQL,MACjCD,EAGV,OAAOQ,CACX,EACAC,qBAAsB,SAASlB,EAAMmB,GAEjC,IADA,IAAIC,EAAgB,KACXV,EAAI,EAAGA,EAAIV,EAAKe,QAAQR,OAAQG,IACrC,GAAIA,IAAMS,EAAa,CACnBC,EAAgBpB,EAAKe,QAAQL,GAC7BV,EAAKe,QAAQT,OAAOI,EAAG,GACvB,KACJ,CAEJ,OAAOU,CACX,EACAC,kBAAmB,WACfpB,KAAKN,MAAME,cAAe,CAC9B,EACAyB,iBAAkB,WACdrB,KAAKN,MAAME,cAAe,CAC9B,EACA0B,oBAAqB,WACjBtB,KAAKN,MAAMG,gBAAiB,CAChC,EACA0B,mBAAoB,WAChBvB,KAAKN,MAAMG,gBAAiB,CAChC,EAER"}