define("mod_otopo/report_group",["core/chartjs","core_table/dynamic","core/ajax","core/log"],(function(e,t,n,s){return{init:function(o,a,c){async function r(e,t,s){var o=n.call([{methodname:"mod_otopo_get_group_chart",args:{otopo:e,users:t,session:s}}]);return await o[0]}function i(t,n,o){r(t,n,o).then((t=>{if(t){const n={data:t,options:{}},s={position:"right"},o={stacked:!0},a={stacked:!0,ticks:{beginAtZero:!0,min:0,max:100,stepSize:10}};c?(n.type="horizontalBar",n.options.legend=s,n.options.scales={xAxes:[o],yAxes:[a]},n.options.tooltips={callbacks:{label:function(e,t){let n=t.datasets[e.datasetIndex].label||"";return n+=": ",n+=t.datasets[e.datasetIndex].data[e.index]||"0",n+="%",n}}}):(n.type="bar",n.options.indexAxis="y",n.options.scales={x:o,y:a},n.options.plugins={},n.options.plugins.legend=s,n.options.plugins.tooltip={callbacks:{label:function(e){if(e){let t=e.dataset.label||"";return t+=": ",t+=e.formattedValue||"0",t+="%",t}return null}}}),new e(document.getElementById("chart"),n)}return!0})).catch(s.error)}const d=document.querySelector(`form[data-table-unique-id="${o}"]`),l=d.dataset.otopo;document.getElementById("chart")&&i(l,document.querySelector("#chart").dataset.users.split(","),document.getElementById("session-selector")&&parseInt(document.getElementById("session-selector").value)?parseInt(document.getElementById("session-selector").value):null),d.addEventListener(t.Events.tableContentRefreshed,(()=>{const e=d.dataset.otopo;if(document.getElementById("chart")){const t=document.querySelector("#chart").dataset.users.split(","),n=document.getElementById("session-selector")&&parseInt(document.getElementById("session-selector").value)?parseInt(document.getElementById("session-selector").value):null;t&&i(e,t,n)}}));var u=0,p=0;window.onbeforeprint=()=>{for(var t in e.instances)p=e.instances[t].canvas.parentNode.style.height,u=e.instances[t].canvas.parentNode.style.width,e.instances[t].canvas.parentNode.style.height="1000px",e.instances[t].canvas.parentNode.style.width="850px",e.instances[t].resize()},window.addEventListener("afterprint",(()=>{for(var t in e.instances)e.instances[t].canvas.parentNode.style.height=p,e.instances[t].canvas.parentNode.style.width=u,e.instances[t].resize()}));const m=document.getElementById("export-csv");m&&(m.onclick=function(e){!function(e){e.preventDefault();const t=document.querySelector("#chart").dataset.users,n=document.getElementById("export-csv").dataset.cmid;location.href=a+"/mod/otopo/view.php?id="+n+"&action=export&object=group&users="+t}(e)})}}}));

//# sourceMappingURL=report_group.min.js.map